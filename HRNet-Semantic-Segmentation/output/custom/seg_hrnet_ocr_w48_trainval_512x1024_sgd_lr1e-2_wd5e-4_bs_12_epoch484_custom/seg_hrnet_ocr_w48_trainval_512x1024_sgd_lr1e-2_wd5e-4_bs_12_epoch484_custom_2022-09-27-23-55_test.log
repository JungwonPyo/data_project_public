2022-09-27 23:55:06,198 Namespace(cfg='./experiments/cityscapes/seg_hrnet_ocr_w48_trainval_512x1024_sgd_lr1e-2_wd5e-4_bs_12_epoch484_custom.yaml', opts=[])
2022-09-27 23:55:06,199 {'AUTO_RESUME': False,
 'CUDNN': CfgNode({'BENCHMARK': True, 'DETERMINISTIC': False, 'ENABLED': True}),
 'DATASET': {'DATASET': 'custom',
             'EXTRA_TRAIN_SET': '',
             'NUM_CLASSES': 19,
             'ROOT': '/media/asura/T7 '
                     'Shield/hospital_large/20220901_10-12/camera_has_mask/img/',
             'TEST_SET': 'test_img_list.txt',
             'TRAIN_SET': 'list/cityscapes/trainval.lst'},
 'DEBUG': {'DEBUG': False,
           'SAVE_BATCH_IMAGES_GT': False,
           'SAVE_BATCH_IMAGES_PRED': False,
           'SAVE_HEATMAPS_GT': False,
           'SAVE_HEATMAPS_PRED': False},
 'GPUS': (0,),
 'LOG_DIR': 'log',
 'LOSS': {'BALANCE_WEIGHTS': [0.4, 1],
          'CLASS_BALANCE': False,
          'OHEMKEEP': 131072,
          'OHEMTHRES': 0.9,
          'USE_OHEM': False},
 'MODEL': {'ALIGN_CORNERS': True,
           'EXTRA': {'FINAL_CONV_KERNEL': 1,
                     'STAGE1': {'BLOCK': 'BOTTLENECK',
                                'FUSE_METHOD': 'SUM',
                                'NUM_BLOCKS': [4],
                                'NUM_CHANNELS': [64],
                                'NUM_MODULES': 1,
                                'NUM_RANCHES': 1},
                     'STAGE2': {'BLOCK': 'BASIC',
                                'FUSE_METHOD': 'SUM',
                                'NUM_BLOCKS': [4, 4],
                                'NUM_BRANCHES': 2,
                                'NUM_CHANNELS': [48, 96],
                                'NUM_MODULES': 1},
                     'STAGE3': {'BLOCK': 'BASIC',
                                'FUSE_METHOD': 'SUM',
                                'NUM_BLOCKS': [4, 4, 4],
                                'NUM_BRANCHES': 3,
                                'NUM_CHANNELS': [48, 96, 192],
                                'NUM_MODULES': 4},
                     'STAGE4': {'BLOCK': 'BASIC',
                                'FUSE_METHOD': 'SUM',
                                'NUM_BLOCKS': [4, 4, 4, 4],
                                'NUM_BRANCHES': 4,
                                'NUM_CHANNELS': [48, 96, 192, 384],
                                'NUM_MODULES': 3}},
           'NAME': 'seg_hrnet_ocr',
           'NUM_OUTPUTS': 2,
           'OCR': {'DROPOUT': 0.05,
                   'KEY_CHANNELS': 256,
                   'MID_CHANNELS': 512,
                   'SCALE': 1},
           'PRETRAINED': 'checkpoints/hrnet_cs_8090_torch11.pth'},
 'OUTPUT_DIR': 'output',
 'PIN_MEMORY': True,
 'PRINT_FREQ': 10,
 'RANK': 0,
 'TEST': {'BASE_SIZE': 2048,
          'BATCH_SIZE_PER_GPU': 1,
          'FLIP_TEST': False,
          'IMAGE_SIZE': [1024, 512],
          'MODEL_FILE': 'checkpoints/hrnet_cs_8090_torch11.pth',
          'MULTI_SCALE': False,
          'NUM_SAMPLES': 0,
          'OUTPUT_INDEX': -1,
          'SCALE_LIST': [1]},
 'TRAIN': {'BASE_SIZE': 2048,
           'BATCH_SIZE_PER_GPU': 3,
           'BEGIN_EPOCH': 0,
           'DOWNSAMPLERATE': 1,
           'END_EPOCH': 484,
           'EXTRA_EPOCH': 0,
           'EXTRA_LR': 0.001,
           'FLIP': True,
           'FREEZE_EPOCHS': -1,
           'FREEZE_LAYERS': '',
           'IGNORE_LABEL': 255,
           'IMAGE_SIZE': [1024, 512],
           'LR': 0.01,
           'LR_FACTOR': 0.1,
           'LR_STEP': [90, 110],
           'MOMENTUM': 0.9,
           'MULTI_SCALE': True,
           'NESTEROV': False,
           'NONBACKBONE_KEYWORDS': [],
           'NONBACKBONE_MULT': 10,
           'NUM_SAMPLES': 0,
           'OPTIMIZER': 'sgd',
           'RANDOM_BRIGHTNESS': False,
           'RANDOM_BRIGHTNESS_SHIFT_VALUE': 10,
           'RESUME': True,
           'SCALE_FACTOR': 16,
           'SHUFFLE': True,
           'WD': 0.0005},
 'WORKERS': 1}
2022-09-27 23:55:06,562 => init weights from normal distribution
2022-09-27 23:55:07,050 => loading pretrained model checkpoints/hrnet_cs_8090_torch11.pth
2022-09-27 23:55:10,446 
Total Parameters: 70,372,678
----------------------------------------------------------------------------------------------------------------------------------
Total Multiply Adds (For Convolution and Linear Layers only): 301.59661865234375 GFLOPs
----------------------------------------------------------------------------------------------------------------------------------
Number of Layers
Conv2d : 316 layers   BatchNorm2d : 314 layers   ReLU : 277 layers   Bottleneck : 4 layers   BasicBlock : 104 layers   HighResolutionModule : 8 layers   SpatialGather_Module : 1 layers   ObjectAttentionBlock2D : 1 layers   Dropout2d : 1 layers   SpatialOCR_Module : 1 layers   
2022-09-27 23:55:10,447 => loading model from checkpoints/hrnet_cs_8090_torch11.pth
2022-09-27 23:55:36,846 Namespace(cfg='./experiments/cityscapes/seg_hrnet_ocr_w48_trainval_512x1024_sgd_lr1e-2_wd5e-4_bs_12_epoch484_custom.yaml', opts=[])
2022-09-27 23:55:36,847 {'AUTO_RESUME': False,
 'CUDNN': CfgNode({'BENCHMARK': True, 'DETERMINISTIC': False, 'ENABLED': True}),
 'DATASET': {'DATASET': 'custom',
             'EXTRA_TRAIN_SET': '',
             'NUM_CLASSES': 19,
             'ROOT': '/media/asura/T7 '
                     'Shield/hospital_large/20220901_10-12/camera_has_mask/img/',
             'TEST_SET': 'test_img_list.txt',
             'TRAIN_SET': 'list/cityscapes/trainval.lst'},
 'DEBUG': {'DEBUG': False,
           'SAVE_BATCH_IMAGES_GT': False,
           'SAVE_BATCH_IMAGES_PRED': False,
           'SAVE_HEATMAPS_GT': False,
           'SAVE_HEATMAPS_PRED': False},
 'GPUS': (0,),
 'LOG_DIR': 'log',
 'LOSS': {'BALANCE_WEIGHTS': [0.4, 1],
          'CLASS_BALANCE': False,
          'OHEMKEEP': 131072,
          'OHEMTHRES': 0.9,
          'USE_OHEM': False},
 'MODEL': {'ALIGN_CORNERS': True,
           'EXTRA': {'FINAL_CONV_KERNEL': 1,
                     'STAGE1': {'BLOCK': 'BOTTLENECK',
                                'FUSE_METHOD': 'SUM',
                                'NUM_BLOCKS': [4],
                                'NUM_CHANNELS': [64],
                                'NUM_MODULES': 1,
                                'NUM_RANCHES': 1},
                     'STAGE2': {'BLOCK': 'BASIC',
                                'FUSE_METHOD': 'SUM',
                                'NUM_BLOCKS': [4, 4],
                                'NUM_BRANCHES': 2,
                                'NUM_CHANNELS': [48, 96],
                                'NUM_MODULES': 1},
                     'STAGE3': {'BLOCK': 'BASIC',
                                'FUSE_METHOD': 'SUM',
                                'NUM_BLOCKS': [4, 4, 4],
                                'NUM_BRANCHES': 3,
                                'NUM_CHANNELS': [48, 96, 192],
                                'NUM_MODULES': 4},
                     'STAGE4': {'BLOCK': 'BASIC',
                                'FUSE_METHOD': 'SUM',
                                'NUM_BLOCKS': [4, 4, 4, 4],
                                'NUM_BRANCHES': 4,
                                'NUM_CHANNELS': [48, 96, 192, 384],
                                'NUM_MODULES': 3}},
           'NAME': 'seg_hrnet_ocr',
           'NUM_OUTPUTS': 2,
           'OCR': {'DROPOUT': 0.05,
                   'KEY_CHANNELS': 256,
                   'MID_CHANNELS': 512,
                   'SCALE': 1},
           'PRETRAINED': 'checkpoints/hrnet_cs_8090_torch11.pth'},
 'OUTPUT_DIR': 'output',
 'PIN_MEMORY': True,
 'PRINT_FREQ': 10,
 'RANK': 0,
 'TEST': {'BASE_SIZE': 2048,
          'BATCH_SIZE_PER_GPU': 1,
          'FLIP_TEST': False,
          'IMAGE_SIZE': [1024, 512],
          'MODEL_FILE': 'checkpoints/hrnet_cs_8090_torch11.pth',
          'MULTI_SCALE': False,
          'NUM_SAMPLES': 0,
          'OUTPUT_INDEX': -1,
          'SCALE_LIST': [1]},
 'TRAIN': {'BASE_SIZE': 2048,
           'BATCH_SIZE_PER_GPU': 3,
           'BEGIN_EPOCH': 0,
           'DOWNSAMPLERATE': 1,
           'END_EPOCH': 484,
           'EXTRA_EPOCH': 0,
           'EXTRA_LR': 0.001,
           'FLIP': True,
           'FREEZE_EPOCHS': -1,
           'FREEZE_LAYERS': '',
           'IGNORE_LABEL': 255,
           'IMAGE_SIZE': [1024, 512],
           'LR': 0.01,
           'LR_FACTOR': 0.1,
           'LR_STEP': [90, 110],
           'MOMENTUM': 0.9,
           'MULTI_SCALE': True,
           'NESTEROV': False,
           'NONBACKBONE_KEYWORDS': [],
           'NONBACKBONE_MULT': 10,
           'NUM_SAMPLES': 0,
           'OPTIMIZER': 'sgd',
           'RANDOM_BRIGHTNESS': False,
           'RANDOM_BRIGHTNESS_SHIFT_VALUE': 10,
           'RESUME': True,
           'SCALE_FACTOR': 16,
           'SHUFFLE': True,
           'WD': 0.0005},
 'WORKERS': 1}
2022-09-27 23:55:37,212 => init weights from normal distribution
2022-09-27 23:55:37,681 => loading pretrained model checkpoints/hrnet_cs_8090_torch11.pth
2022-09-27 23:55:40,834 
Total Parameters: 70,372,678
----------------------------------------------------------------------------------------------------------------------------------
Total Multiply Adds (For Convolution and Linear Layers only): 301.59661865234375 GFLOPs
----------------------------------------------------------------------------------------------------------------------------------
Number of Layers
Conv2d : 316 layers   BatchNorm2d : 314 layers   ReLU : 277 layers   Bottleneck : 4 layers   BasicBlock : 104 layers   HighResolutionModule : 8 layers   SpatialGather_Module : 1 layers   ObjectAttentionBlock2D : 1 layers   Dropout2d : 1 layers   SpatialOCR_Module : 1 layers   
2022-09-27 23:55:40,835 => loading model from checkpoints/hrnet_cs_8090_torch11.pth
